<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="UTF-8" />
		<meta http-equiv="X-UA-Compatible" content="IE=edge" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0" />
		<title>Document</title>
	</head>
	<body>
		<canvas id="canvas" style="border: 1px solid red" width="1400" height="900"
			>Canvas not supported</canvas
		>
		<!-- <div style="border: 1px solid red; width: 600px; height: 600px" id="target">
			Hello
		</div> -->
		<script src="./Shooter.js"></script>
		<script>
			let target = document.getElementById('canvas')

			const canvas = document.getElementById('canvas')
			const ctx = canvas.getContext('2d')
			let T = 0
			let radios = 80
			let oldTimestamp = 0
			let secondsPassed = 0
			const animationSpeed = 10
			let angle = 0
			let X0 = 200
			let Y0 = canvas.height
			let x = X0
			let y = Y0
			let speed = 0
			let hipo = 0
			let timeElapsed = 0
			const g = 0.0005
			window.onload = init()
			function shoot(res) {
				console.log('Shooted')
				hipo = res.hipo
				timeElapsed = res.timeElapsed
				angle = res.angle
				speed = hipo / timeElapsed
				console.log(
					'result from shooter shootEvent and asigne locally :',
					hipo,
					angle,
					timeElapsed
				)
				window.requestAnimationFrame(animiationLoop)
			}
			function init() {
				let shooter = new Shooter(target, shoot)
				console.log('adding Events')
				shooter.addListeners()
				// window.requestAnimationFrame(animiationLoop)
			}

			function animiationLoop(timeStamp) {
				secondsPassed = (timeStamp - oldTimestamp) / 1000
				oldTimestamp = timeStamp

				update()
				draw()
				window.requestAnimationFrame(animiationLoop)
			}
			function update() {
				let speed = hipo / timeElapsed
				console.log('updating...')
				console.log('speed:', speed)
				console.log('angle :', angle)
				console.log('hipo : ', hipo)
				T += animationSpeed * secondsPassed
				x = speed * Math.cos((-angle * Math.PI) / 180) * T + X0
				y =
					0.5 * g * T ** 2 + 3*speed * Math.sin((-angle * Math.PI) / 180) * T + Y0
				radios = radios * 0.9989
				console.log('printing Circle cordination : ', x, y)
			}
			function draw() {
				ctx.clearRect(0, 0, canvas.width, canvas.height)
				ctx.beginPath()
				ctx.arc(x, y, radios, 0, 2 * Math.PI)
				ctx.fill()
			}
		</script>
	</body>
</html>
